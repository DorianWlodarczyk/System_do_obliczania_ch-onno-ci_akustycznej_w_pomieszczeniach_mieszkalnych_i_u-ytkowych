{% extends "base.html" %}
{% block title %}Measurement Form{% endblock %}
{% block content %}

<form method="POST">
  <h3 align="center">Projekt pomieszczenia</h3>
<div class="form-group" >
    <label style="font-size: 30px;  " for="projectName">Nazwa projektu:</label>
    <input type="text" class="form-control" id="projectName" placeholder="Wpisz nazwę projektu">
</div>
  <div class="form-group">
    <label for="norms">Wybierz norme budowlaną</label>
    <select class="form-control" id="norms" name="norms">
        {% for norm in norms %}
            <option value="{{ norm.id }}">{{ norm.name }}</option>
        {% endfor %}
    </select>
  </div>
  <div class="form-group">
    <label for="length">Długość pomieszczenia</label>
    <input
      type="number"
      class="form-control"
      id="length"
      name="length"
      placeholder="Wpisz długość pomieszczenia"
    />
  </div>
  <div class="form-group">
    <label for="width">Szerokość pomieszczenia</label>
    <input
      type="number"
      class="form-control"
      id="width"
      name="width"
      placeholder="Wpisz szerokość pomieszczenia"
    />
  </div>
  <div class="form-group">
    <label for="height">Wysokość pomieszczenia</label>
    <input
      type="number"
      class="form-control"
      id="height"
      name="height"
      placeholder="Wpisz wysokość pomieszczenia"
    />
  </div>

    <button onclick="calculate_wall_area()" class="btn btn-primary">Oblicz wymiary pomieszcenia </button>
    <div id="volume"></div>
    <div id="prawa"></div>
    <div id="lewa"></div>
    <div id="na_wprost"></div>
    <div id="tyl"></div>


   <div class="form-group">
    <label style="font-size: 20px" for="sufit">Wybierz materjał dla sufitu</label>
    <select class="form-control" id="sufit" name="sufit" >
        <option value="null" selected>------------</option>
        {% for material_ceiling in materials_ceiling %}
            <option value="{{ material_ceiling.id }}">{{ material_ceiling.name }}</option>
        {% endfor %}
    </select>
  </div>
   <div id="selected-items"></div>

<div class="form-group">
    <label style="font-size: 20px" for="norms">Wybierz materjał ściany prawej</label>
    <select class="form-control" id="wall1" name="wall1">
    <option value="null" selected>------------</option>
        {% for material_wall in materials_walls %}
            <option value="{{ material_wall.id }}" >{{ material_wall.name }}</option>
        {% endfor %}
    </select>
  </div>

  <div class="form-group">
    <label style="font-size: 20px" for="norms">Wybierz materjał ściany lewej</label>
    <select class="form-control" id="wall2" name="wall2">
    <option value=null selected>------------</option>
        {% for material_wall in materials_walls %}
            <option value="{{ material_wall.id }}" >{{ material_wall.name }}</option>
        {% endfor %}
    </select>
  </div>

<div class="form-group">
    <label style="font-size: 20px" for="norms">Wybierz materjał ściany na wprost</label>
    <select class="form-control" id="wall3" name="wall3">
    <option value="null" selected>------------</option>
        {% for material_wall in materials_walls %}
            <option value="{{ material_wall.id }}" >{{ material_wall.name }}</option>
        {% endfor %}
    </select>
  </div>

<div class="form-group">
    <label style="font-size: 20px" for="norms">Wybierz materjał ściany z tyłu</label>
    <select class="form-control" id="wall4" name="wall4">
    <option value="null" selected>------------</option>
        {% for material_wall in materials_walls %}
            <option value="{{ material_wall.id }}" >{{ material_wall.name }}</option>
        {% endfor %}
    </select>
  </div>

<div class="form-group">
    <label style="font-size: 20px" for="flor">Wybierz materjał dla podłogi</label>
    <select class="form-control" id="podloga" name="podloga">
    <option value="null" selected>------------</option>
        {% for material_floor in material_floor %}
            <option value="{{ material_floor.id }}">{{ material_floor.name }}</option>
        {% endfor %}
    </select>
</div>

<div class="form-group">
    <label style="font-size: 20px" for="Other">Dodaj wyposażenie wnętrza </label>
    <select class="form-control" id="Inne" name="Inne" multiple>
        {% for material_other in material_other %}
            <option value="{{ material_other.id }}" onclick="addMaterialOther(this)">{{ material_other.name }}</option>
        {% endfor %}
    </select>
  </div>

<div id="selected-materials">
    <h4>Wybrane wyposażenie wnetrza:</h4>
    <ul id="material-other-list"></ul>
</div>
<br/>
 <button type="button" class="btn btn-secondary" id="submit-button" onClick='window.location.href = "{{ url_for('views.save_project') }}"'>Zapisz projekt</button>
 <button type="button" class="btn btn-secondary" id="checker-button">Sprawdź czy pomieszczenie spełnia normy</button>
</form>
<script>
document.getElementById("submit-button").enabled = true;
document.getElementById("checker-button").disabled = true;
let sufit = document.getElementById("sufit");
sufit.addEventListener("change", checkInputs);
let wall_1 = document.getElementById("wall1");
wall_1.addEventListener("change", checkInputs);
let wall_2 = document.getElementById("wall2");
wall_2.addEventListener("change", checkInputs);
let wall_3 = document.getElementById("wall3");
wall_3.addEventListener("change", checkInputs);
const wall_4 = document.getElementById("wall4");
wall_4.addEventListener("change", checkInputs);
const podloga = document.getElementById("podloga");
podloga.addEventListener("change", checkInputs);


function checkInputs() {
  if (wall_1.value !== "null" && wall_2.value !== "null" && wall_3.value !== "null" && wall_4.value !== "null" && sufit.value !=="null" && podloga.value !== "null") {
    document.getElementById("submit-button").disabled = false;
    document.getElementById("checker-button").disabled = false;
  } else {
    document.getElementById("submit-button").disabled = true;
    document.getElementById("checker-button").disabled = true;
  }
}

function calculate_wall_area() {
        const length = document.getElementById("length").value;
        const width = document.getElementById("width").value;
        const height = document.getElementById("height").value;
        const volume = length * height * width;
        const prawa = length * height;
        const lewa = length * height;
        const na_wprost = width * height;
        const tyl = width * height;
        const sufit_wymiar = length * width;
        const podloga = sufit
        document.getElementById("volume").innerHTML = "Obietość pomieszcenia: " + volume + "m³";
      document.getElementById("prawa").innerHTML = "Wymiar ściny prawej: " + prawa + "m²";
      document.getElementById("lewa").innerHTML = "Wymiar ściany lewej: " + lewa + "m²";
      document.getElementById("na_wprost").innerHTML = "Wymiar ściany na wprost: " + na_wprost + "m²";
      document.getElementById("tyl").innerHTML = "Wymiar ściany z tyłu: " + tyl + "m²";
      document.getElementById("sufit_wymiar").innerHTML = "Wymiar sufitu: " + sufit_wymiar + "m²";
      document.getElementById("podloga").innerHTML = "Wymiar podłogi: " + podloga + "m²";
        }


       function addMaterialOther(element) {
        var materialId = element.value;
        var materialName = element.text;
        var selectedMaterials = document.getElementById("material-other-list");
        var newMaterial = document.createElement("li");
        var removeButton = document.createElement("button");
        removeButton.innerHTML = "x";
        removeButton.setAttribute("onclick", "removeMaterial(this)");
        newMaterial.innerHTML = materialName;
        newMaterial.setAttribute("data-material-id", materialId);
        newMaterial.appendChild(removeButton);
        selectedMaterials.appendChild(newMaterial);
    }

    function removeMaterial(element) {
        element.parentNode.remove();
    }
</script>

{% endblock %}
